function initMeganavFunctions(){var n=$(".main_nav.desktop"),t=$(".meganav");checkChildForSubmenus(n);insertTitleIntoSubmenu(n);insertMeganavPromos(t,n);setChildListLimits(n,"ul.d2",12,!1);setChildListLimits(n,"ul.d3, ul.d4, ul.d5",14,!0);resizeMeganavContainer(n);keyboardNav($(".main_nav > ul"))}function getChildFromListElement(n){return n.find("> ul")}function getDataAttribute(n,t){return n.attr(t)}function getChildren(n,t){return n.find(t)}function checkChildForSubmenus(n){function i(n,t){return $(n).addClass(t)}function r(n){return n.find("> li:not(.colHeading)").length}function u(n){return n.find("> li.hasChild")}function t(n,t,i){return n.attr(t,i)}function f(n){var t=0,i=getChildren(n,"> li:not(.menuTitle)");return $.each(i,function(){t=t+$(this).actual("outerHeight")}),t}var e=n.find("ul");$.each(e,function(){var n=$(this),e=u(n);return t(n,"data-height",f(n)),t(n,"data-childcount",r(n)),e.length>0?i(n,"hasSubmenu"):void 0})}function insertTitleIntoSubmenu(n){var t=n.children("ul").children("li");$.each(t,function(){var n=$(this),t=n.find("> a").attr("href"),i=n.find("> a span").text(),r=n.children("ul");r.prepend('<li class="menuTitle"><a class="titleButton" href="'+t+'">'+i+"<\/a><\/li>")})}function insertMeganavPromos(n,t){var i=n.children(),r=t.children("ul.d1").children("li");$.each(i,function(){var n=$(this),t=n.html(),i=n.attr("class");$.each(r,function(){if($(this).hasClass(i))return $(this).find("> ul").addClass("hasPromo"),$(this).append('<div class="megaNavCE">'+t+"<\/div>")})})}function setChildListLimits(n,t,i,r){function u(n){return n.length}function f(n){return n.hasClass("hasSubmenu")}function e(n,t){return $(n).addClass(t)}var o=n,s=getChildren(o,t);$.each(s,function(){var n=$(this),t=getChildren(n,"> li");(!r||r&&f(n))&&u(t)>i&&e(t[i],"lastElement")})}function resizeMeganavContainer(n){function f(n){return n.find("ul.d2")}function e(n){return n.closest("ul.d2")}function h(n){return n.closest("ul")}function c(n){return n.find("a")}function t(n,t,i){var r=i||"";return t==="add"&&typeof r=="number"?$(n).css({height:r}):t==="remove"?$(n).removeAttr("style"):void 0}function o(n){return n>i.MEGANAV_MAX_HEIGHT?i.MEGANAV_MAX_HEIGHT:n}function s(n){var u=n,i=e(u),f,v=getChildFromListElement(u),c=parseInt(getDataAttribute(v,"data-height"))+r,y=h(u),l=n.parents("ul:not(.d1, .d2)"),s,a;return(f=y.hasClass("d2")?parseInt(getDataAttribute(i,"data-height"))+r:parseInt(i.css("height"))||parseInt(getDataAttribute(i,"data-height"))+r,c>=f)?t(i,"add",o(c)):(t(i,"remove"),l.length>0&&(s=l.filter(function(){var n=parseInt(getDataAttribute($(this),"data-height"))+r;return n>=f}),s.length>0))?(a=parseInt(getDataAttribute(s,"data-height"))+r,t(i,"add",o(a))):void 0}var i={MEGANAV_BORDER:5,MEGANAV_MENUTITLE_HEIGHT:46,MEGANAV_MENUTITLE_MARGIN:15,MAGIC_PIXEL:6,MEGANAV_MAX_HEIGHT:510},r=i.MEGANAV_BORDER+i.MEGANAV_MENUTITLE_HEIGHT+i.MEGANAV_MENUTITLE_MARGIN+i.MAGIC_PIXEL,u=f(n),l=$children=n.children("ul.d1").find("> li"),a=$children=n.children("ul.d1").find("> li > a"),v=f(n).find("li"),y=f(n).find("li.hasChild > a"),p=c(n).last();l.on({mouseenter:function(){return t(u,"remove")}});a.on({focus:function(){return t(u,"remove")}});v.on({mouseenter:function(){return s($(this))}});y.on({focus:function(){return s($(this).closest("li"))}});p.on({keydown:function(n){if(n.which==9)return t(u,"remove")}});$(document).click(function(n){if(!$(n.target).closest(".main_nav").length)return t(u,"remove")})}(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):n(jQuery)})(function(n){n.fn.addBack=n.fn.addBack||n.fn.andSelf;n.fn.extend({actual:function(t,i){var s,u,h,c;if(!this[t])throw'$.actual => The jQuery method "'+t+'" you called does not exist';var f=n.extend({absolute:!1,clone:!1,includeMargin:!1,display:"block"},i),r=this.eq(0),e,o;return f.clone===!0?(e=function(){r=r.clone().attr("style","position: absolute !important; top: -1000 !important; ").appendTo("body")},o=function(){r.remove()}):(s=[],u="",e=function(){h=r.parents().addBack().filter(":hidden");u+="visibility: hidden !important; display: "+f.display+" !important; ";f.absolute===!0&&(u+="position: absolute !important; ");h.each(function(){var i=n(this),t=i.attr("style");s.push(t);i.attr("style",t?t+";"+u:u)})},o=function(){h.each(function(t){var i=n(this),r=s[t];r===undefined?i.removeAttr("style"):i.attr("style",r)})}),e(),c=/(outer)/.test(t)?r[t](f.includeMargin):r[t](),o(),c}})});$(document).ready(function(){typeof megaNavMenu=="undefined"||isNaN(megaNavMenu.Index)||newsAndEventsNav.init("i"+parseInt(megaNavMenu.Index));$("body").data("master")==="global-site"?ourSchoolsMeganav.initOurSchools($(".main_nav.desktop")):initMeganavFunctions()});var ourSchoolsMeganav={xmlOurSchools:null,menuClass:"i3",initOurSchools:function(){$(".main_nav > ul > li."+ourSchoolsMeganav.menuClass).addClass("ourSchoolsMeganav");$.get("/_cms-site-content/_corporate2/xml/schools.xml?v=53",null,function(n){ourSchoolsMeganav.xmlOurSchools=n;ourSchoolsMeganav.createOurSchools($(".ourSchoolsMeganav"))})},createOurSchools:function(n){var i,t;for(n.find("ul.d2 li").not(".menuTitle").remove(),i=ourSchoolsMeganav.xmlOurSchools.getElementsByTagName("region"),t=0;t<i.length;t++)ourSchoolsMeganav.addRegion(n.find("ul.d2"),i[t]);n.find(".menuTitle").after('<li class="colHeading"><p>Region<\/p><\/li>');n.find("ul.d3").prepend('<li class="colHeading"><p>Country<\/p><\/li>');n.find("ul.d4").prepend('<li class="colHeading"><p>City<\/p><\/li>');n.find("ul.d5").prepend('<li class="colHeading"><p>School<\/p><\/li>');initMeganavFunctions();n.find("li.menuTitle").append('<div class="ourSchoolLinks"><a class="link all" href="/schools">All Schools<\/a><\/div><div class="ourBoardingLinks"><a class="link boarding" href="/schools/boarding-schools">Our Boarding Schools<\/a><\/div>')},addRegion:function(n,t){var i=$("<li><\/li>"),o=n.find("> li").length+1,e=t.getElementsByTagName("country"),u=t.getAttribute("url"),s="",f,h,r;for((u==""||u==null)&&(u="#",s="noLink"),i.addClass("i"+o),o==1&&i.addClass("first"),e.length>0&&i.addClass("hasChild"),f=[],f.push("<a href='"+u+"' class='"+s+"'><span>"+t.getAttribute("name")+"<\/span><\/a>"),f.push("<ul class='d3 clearfix'><\/ul>"),i.append(f.join("")),n.append(i),h=i.find("ul.d3"),r=0;r<e.length;r=r+1)ourSchoolsMeganav.addCountry(h,e[r])},addCountry:function(n,t){var i=$("<li><\/li>"),o=n.find("li").length+1,e=t.getElementsByTagName("city"),u=t.getAttribute("url"),s="",f,h,r;for((u==""||u==null)&&(u="#",s="noLink"),i.addClass("i"+o),o==1&&i.addClass("first"),e.length>0&&i.addClass("hasChild"),f=[],f.push("<a href='"+u+"' class='"+s+"'><span>"+t.getAttribute("name")+"<\/span><\/a>"),f.push('<ul class="d4 clearfix"><\/ul>'),i.append(f.join("")),n.append(i),h=i.find("ul.d4"),r=0;r<e.length;r=r+1)ourSchoolsMeganav.addCity(h,e[r])},addCity:function(n,t){var i=$("<li><\/li>"),o=n.find("li").length+1,e=t.getElementsByTagName("school"),f=t.getAttribute("url"),s="",r,h,u;for((f==""||f==null)&&(f="#",s="noLink"),i.addClass("i"+o),o==1&&i.addClass("first"),e.length>0&&i.addClass("hasChild"),r=[],r.push("<a href='"+f+"' class='"+s+"'><span>"+t.getAttribute("name")+"<\/span><\/a>"),r.push('<ul class="d5 clearfix">'),r.push("<\/ul>"),i.append(r.join("")),n.append(i),h=i.find("ul.d5"),u=0;u<e.length;u=u+1)ourSchoolsMeganav.addSchool(h,e[u])},addSchool:function(n,t){var i=$("<li><\/li>"),u=n.find("li").length+1,f=t.getElementsByTagName("school"),r;i.addClass("i"+u);u==1&&i.addClass("first");f.length>0&&i.addClass("hasChild");r=[];r.push('<a href="'+t.getAttribute("url")+'"><span>'+t.getAttribute("name")+"<\/span><\/a>");i.append(r.join(""));n.append(i)}},keyboardNav=function(n){function a(n){return n.children("li").find("> a")}function e(n){return n.find("a")}function i(n,t){return t=t||"li",n.parent(t)}function r(n){var t=i(n);return t.addClass("js-hover")}function v(n){var t=i(n);return t.removeClass("js-hover")}function d(n){var t=i(n);return t.toggleClass("js-hover")}function y(n){var i=n.find("~ ul"),t=a(i).first();return t.focus(),r(t)}function g(n,t){return t=t||"> a",n.parent().prev().find(t)}function nt(n,t){return t=t||"> a",n.parent().next().find(t)}function p(n){return n.closest("ul").prev()}function tt(n){return n.closest("li").is(":last-child")||n.closest("li").hasClass("lastElement")?!0:!1}function u(n,t){var i;return(t==="next"?i=nt(n):t==="prev"&&(i=g(n)),t==="prev"&&i.length===0)?p(n).focus():i.length>0?(v(n),i.focus(),r(i)):void 0}function f(n){var t=n.find(".js-hover");$.each(t,function(){var n=$(this);return n.blur(),n.removeClass("js-hover")})}function it(n){var t=n.siblings();$.each(t,function(){var n=$(this);n.removeClass("js-hover")})}function rt(n){var t=n.siblings();$.each(t,function(){var n=$(this),t=e(n);$.each(t,function(){var n=i($(this));n.hasClass("js-hover")&&n.removeClass("js-hover")})})}function o(n){return $("body").removeClass("keyHighlight"),$("body").removeClass("tabHighlight"),f(n)}var t=n,ut=a(t),ft=e(t.find("ul.d2")),w=e(t),et=w.last();const b=9,k=27,s=37,h=38,c=39,l=40;w.on({keydown:function(n){switch(n.which){case s:case h:case c:case l:return $("body").hasClass("keyHighlight")||$("body").addClass("keyHighlight"),n.preventDefault()}}});ut.on({focus:function(){return f(t),d($(this))},keydown:function(n){return n.which===k?f(t):n.which===s?u($(this),"prev"):n.which===h?v($(this)):n.which===c?u($(this),"next"):n.which===l?(r($(this)),y($(this))):void 0}});ft.on({keyup:function(n){if(n.which===b){var o=$(this),e=i($(this));it(e);rt(e);r(o)}else{if(n.which===k)return f(t);if(n.which===s)return p($(this)).focus();if(n.which===h)return u($(this),"prev");if(n.which===c)return y($(this));if(n.which===l&&!tt($(this)))return u($(this),"next")}}});et.on({keydown:function(n){if(n.which===b)return o(t)}});$(document).click(function(n){if(!$(n.target).closest(".main_nav").length)return o(t)});$(document).on({mousemove:function(n){var i=$(n.target).closest(".main_nav").length,r=$("body").hasClass("keyHighlight")||$("body").hasClass("tabHighlight");if(!i&&r)return o(t)}})},newsAndEventsNav={menuIdentifier:"",desktopId:"js-newsAndEventsMeganav",mobileId:"js-newsAndEventsMeganavMobile",navClass:"newsAndEventsMeganav",desktopNavElement:"",mobileNavElement:"",parentUrl:"",addedUrls:[],sectionUrls:{News:"news",Blogs:"blog",Events:"events",Authors:"blog/author"},mobileSectionUrls:{News:"news",Blogs:"blogs",Events:"calendar",Authors:"blogs"},init:function(n){newsAndEventsNav.menuIdentifier=n;newsAndEventsNav.loadData()},loadData:function(){typeof megaNavMenu=="object"&&newsAndEventsNav.createMenu(megaNavMenu)},createMenu:function(n){newsAndEventsNav.addNavClasses(newsAndEventsNav.menuIdentifier);newsAndEventsNav.desktopNavElement=newsAndEventsNav.saveDesktopNavElement();newsAndEventsNav.mobileNavElement=newsAndEventsNav.saveMobileNavElement();newsAndEventsNav.parentUrl=newsAndEventsNav.setNavUrl();$("."+newsAndEventsNav.menuIdentifier).find(".d2").length===0&&$("."+newsAndEventsNav.menuIdentifier).append('<ul class="d2"><\/ul>');var t=newsAndEventsNav.desktopNavElement.find("ul.d2 li:not(.menuTitle)");newsAndEventsNav.emptyNav();newsAndEventsNav.createNavSections(n);newsAndEventsNav.populateUnpopulated(n,t);newsAndEventsNav.desktopNavElement.find("ul.d2 li:last-of-type").addClass("last");newsAndEventsNav.mobileNavElement.find("ul.d2 li:last-of-type").addClass("last");newsAndEventsNav.addMobileDropdown()},addNavClasses:function(n){$(".main_nav > ul > li."+n).attr("id",newsAndEventsNav.desktopId).addClass(newsAndEventsNav.navClass+" hasChild");$(".simpleMobileNav > ul:not(.mobilenav) > li."+n).attr("id",newsAndEventsNav.mobileId).addClass(newsAndEventsNav.navClass+" hasChild")},saveDesktopNavElement:function(){return $("#"+newsAndEventsNav.desktopId)},saveMobileNavElement:function(){return $("#"+newsAndEventsNav.mobileId)},setNavUrl:function(){return newsAndEventsNav.desktopNavElement.find("a").attr("href")},emptyNav:function(){newsAndEventsNav.desktopNavElement.find("ul.d2 li:not(.menuTitle)").remove();newsAndEventsNav.mobileNavElement.find("ul.d2 li").remove()},populateUnpopulated:function(n,t){var e=newsAndEventsNav.desktopNavElement.length,u=[],f=!1,i=0,r=0;t.each(function(n){var o,s,h;e+=1;o=$(t[n]);f?(h=t[i],$(h).find("ul:first").append(o),o.hasClass("last")&&(r--,u.pop(),r==0?(f=!1,i=0):i=u[r-1])):o.attr("Datatype")=="news"||o.attr("Datatype")=="blogs"||o.attr("Datatype")=="events"||o.attr("Datatype")=="author"||(s=$(t[n]).clone(),newsAndEventsNav.appendNavHtml(newsAndEventsNav.desktopNavElement,o),newsAndEventsNav.appendNavHtml(newsAndEventsNav.mobileNavElement,s));o.hasClass("hasChild")&&(f=!0,i=n,u.push(i),r++)})},createNavSections:function(n){var t=1;typeof n.Articles=="object"?n.Articles.forEach(function(n){n.Name!=="Job Vacancies"&&(newsAndEventsNav.appendDesktopMobileHtml(n,t),t+=1)}):(newsAndEventsNav.appendDesktopMobileHtml({Name:"News",Datatype:"news"},t),t+=1,newsAndEventsNav.appendDesktopMobileHtml({Name:"Blogs",Datatype:"blogs"},t),t+=1);typeof n.Events=="object"?n.Events.forEach(function(n){newsAndEventsNav.appendDesktopMobileHtml(n,t);t+=1}):(newsAndEventsNav.appendDesktopMobileHtml({Name:"Events",Datatype:"events"},t),t+=1);typeof n.Authors=="object"&&n.Authors.forEach(function(n){newsAndEventsNav.appendDesktopMobileHtml(n,t);t+=1})},appendDesktopMobileHtml:function(n,t){newsAndEventsNav.appendNavHtml(newsAndEventsNav.desktopNavElement,newsAndEventsNav.createSection(n,t,!0));newsAndEventsNav.appendNavHtml(newsAndEventsNav.mobileNavElement,newsAndEventsNav.createSection(n,t))},appendNavHtml:function(n,t){n.find("ul.d2").append(t)},createSection:function(n,t,i){var e="i"+t,o=t!==1?e:e+" first",s=[],h=0,u=newsAndEventsNav.parentUrl+"/",r=n.Name,f;return r.indexOf("News")>=0?r="News":r.indexOf("Blog")>=0&&(r="Blogs"),f=r,typeof newsAndEventsNavLanguageStrings!="undefined"&&typeof newsAndEventsNavLanguageStrings[r.toLowerCase()]!="undefined"&&(f=newsAndEventsNavLanguageStrings[r.toLowerCase()]),u+=i?"#"+newsAndEventsNav.sectionUrls[r]:newsAndEventsNav.mobileSectionUrls[r],i&&typeof n.Categories!="undefined"&&n.Categories.length&&(n.Categories.forEach(function(n){n.Enabled&&(h+=1)}),h&&r!=="Events"&&(o+=" hasChild",s=newsAndEventsNav.createCategories(r,n.Categories,u))),'<li datatype="'+n.Datatype+'" class="'+o+'"><a href="'+u+'"><span>'+f+"<\/span><\/a> "+s+"<\/li>"},createCategories:function(n,t,i){var r=1,u='<ul class="d3 clearfix">';return t.forEach(function(t){if(t.Enabled){var e="i"+r,o=r!==1?e:e+" first",f=i+"/";n!=="Authors"&&(f+="category/");f+=newsAndEventsNav.convertToSlug(t.ID);u+='<li class="'+o+'"><a href="'+f+'"><span>'+t.Name+"<\/span><\/a><\/li>";r+=1}}),u+="<\/ul>"},convertToSlug:function(n){return n.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,"")},addMobileDropdown:function(){$("#js-newsAndEventsMeganavMobile").each(function(){$(this).append('<span class="openSubMenu"><\/span>');var n=$(this).find("> .openSubMenu");n.click(function(){var n=$(this),i=n.parent(),t=i.find("> ul");n.hasClass("open")==!0?newsAndEventsNav.closeSubMenu(t,function(){n.removeClass("open")}):newsAndEventsNav.openSubMenu(t,function(){n.addClass("open")})})})},openSubMenu:function(n,t){n.show();t!=null&&t()},closeSubMenu:function(n,t){n.hide();t!=null&&t()}}